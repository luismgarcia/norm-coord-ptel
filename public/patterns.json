{
  "version": "1.1.0",
  "lastUpdate": "2024-11-27",
  "description": "Patrones comunitarios para normalización de coordenadas PTEL Andalucía",
  "repository": "https://github.com/luismgarcia/norm-coord-ptel",
  "changelog": [
    "v1.1.0 (2024-11-27): Añadidos patrones de Berja (DOUBLE_DOT, SPANISH_FORMAT)",
    "v1.0.0 (2024-11-27): Versión inicial con patrones de Hornos, Tijola"
  ],
  "patterns": [
    {
      "id": "KM_DECIMAL_X",
      "name": "X en kilómetros con decimales",
      "description": "Coordenada X expresada en km con punto decimal (ej: 524.643 → 524643). Detectado en documentos de Hornos, Castril y otros municipios de Jaén.",
      "field": "x",
      "condition": { "type": "range", "minValue": 100, "maxValue": 999 },
      "transform": { "type": "multiply", "factor": 1000 },
      "confidence": 95,
      "uses": 54,
      "successes": 54,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-27T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Hornos", "Castril de la Peña", "Segura de la Sierra", "Santiago-Pontones"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "Y_TRUNCATED_6_MULT10",
      "name": "Y truncada con 6 dígitos (×10)",
      "description": "Coordenada Y con 6 dígitos empezando por 4 pero fuera de rango. Caso Tijola: 413364 → 4133640.",
      "field": "y",
      "condition": { "type": "range", "minValue": 400000, "maxValue": 432000 },
      "transform": { "type": "multiply", "factor": 10 },
      "confidence": 92,
      "uses": 15,
      "successes": 15,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-27T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Tíjola", "Almócita", "Berja"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "Y_TRUNCATED_6_ADD4",
      "name": "Y truncada con 6 dígitos (añadir 4)",
      "description": "Coordenada Y con solo 6 dígitos, falta el '4' inicial (ej: 133364 → 4133364).",
      "field": "y",
      "condition": { "type": "range", "minValue": 100000, "maxValue": 399999 },
      "transform": { "type": "add", "addend": 4000000 },
      "confidence": 92,
      "uses": 23,
      "successes": 23,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-20T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Colomera", "Quéntar"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "X_TRUNCATED_5_DIGITS",
      "name": "X truncada con 5 dígitos",
      "description": "Coordenada X con solo 5 dígitos, falta un dígito al final (ej: 44785 → 447850).",
      "field": "x",
      "condition": { "type": "digits", "digitCount": 5 },
      "transform": { "type": "multiply", "factor": 10 },
      "confidence": 85,
      "uses": 12,
      "successes": 11,
      "failures": 1,
      "source": "community",
      "firstSeen": "2024-11-22T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Quéntar", "Güéjar Sierra"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "DOUBLE_DOT_DECIMAL",
      "name": "Doble punto como decimal",
      "description": "Error tipográfico: doble punto en lugar de punto simple (ej: 4076464..97 → 4076464.97). Detectado en Berja.",
      "field": "both",
      "condition": { "type": "regex", "pattern": "\\d+\\.\\.\\d+" },
      "transform": { "type": "replace", "pattern": "\\.\\.", "replacement": "." },
      "confidence": 95,
      "uses": 3,
      "successes": 3,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-27T12:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Berja"],
      "isStable": false,
      "version": "1.1.0"
    },
    {
      "id": "SPANISH_FORMAT_LONG",
      "name": "Formato español largo (punto miles, coma decimal)",
      "description": "Formato numérico español con punto como separador de miles y coma como decimal (ej: 4.077.905,68 → 4077905.68).",
      "field": "both",
      "condition": { "type": "regex", "pattern": "^\\d{1,3}\\.\\d{3}\\.\\d{3},\\d+$" },
      "transform": { "type": "replace", "pattern": "(\\d{1,3})\\.(\\d{3})\\.(\\d{3}),(\\d+)", "replacement": "$1$2$3.$4" },
      "confidence": 92,
      "uses": 5,
      "successes": 5,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-27T12:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Berja"],
      "isStable": false,
      "version": "1.1.0"
    },
    {
      "id": "SPANISH_FORMAT_SHORT",
      "name": "Formato español corto (punto miles, coma decimal)",
      "description": "Formato numérico español corto (ej: 504.352,98 → 504352.98).",
      "field": "both",
      "condition": { "type": "regex", "pattern": "^\\d{3}\\.\\d{3},\\d+$" },
      "transform": { "type": "replace", "pattern": "(\\d{3})\\.(\\d{3}),(\\d+)", "replacement": "$1$2.$3" },
      "confidence": 90,
      "uses": 2,
      "successes": 2,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-27T12:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Berja"],
      "isStable": false,
      "version": "1.1.0"
    },
    {
      "id": "DOUBLE_TILDE_DECIMAL",
      "name": "Doble tilde como separador decimal",
      "description": "Uso de doble tilde (´´) como separador decimal, muy común en documentos de Almería.",
      "field": "both",
      "condition": { "type": "regex", "pattern": "\\d+\\s*´´\\s*\\d+" },
      "transform": { "type": "replace", "pattern": "\\s*´´\\s*", "replacement": "." },
      "confidence": 95,
      "uses": 67,
      "successes": 67,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-15T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Berja", "Dalías", "El Ejido", "Roquetas de Mar", "Garrucha"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "SPACE_THOUSANDS",
      "name": "Espacio como separador de miles",
      "description": "Espacio usado para separar miles (ej: 447 850 → 447850 o 4 077 841 → 4077841).",
      "field": "both",
      "condition": { "type": "regex", "pattern": "^\\d{1,3}\\s+\\d{3}(\\s+\\d{3})?(\\.\\d+)?$" },
      "transform": { "type": "replace", "pattern": "\\s+", "replacement": "" },
      "confidence": 90,
      "uses": 45,
      "successes": 45,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-18T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Colomera", "Moclín", "Iznalloz", "Berja"],
      "isStable": true,
      "version": "1.0.0"
    },
    {
      "id": "Y_KM_INTEGER",
      "name": "Y en kilómetros (entero)",
      "description": "Coordenada Y expresada en km sin decimales (ej: 4133 → 4133000).",
      "field": "y",
      "condition": { "type": "range", "minValue": 3980, "maxValue": 4320 },
      "transform": { "type": "multiply", "factor": 1000 },
      "confidence": 88,
      "uses": 5,
      "successes": 5,
      "failures": 0,
      "source": "community",
      "firstSeen": "2024-11-26T00:00:00Z",
      "lastUsed": "2024-11-27T12:00:00Z",
      "municipalities": ["Hornos"],
      "isStable": false,
      "version": "1.0.0"
    }
  ],
  "metadata": {
    "totalDocumentsAnalyzed": 181,
    "totalMunicipalitiesCovered": 12,
    "provinces": ["Almería", "Granada", "Jaén"],
    "validationRate": 96.1,
    "contributors": ["PTEL Development Team"],
    "nextReviewDate": "2025-01-15"
  },
  "statistics": {
    "byProvince": {
      "Almería": { "documents": 8, "records": 89, "validRate": 97.8 },
      "Granada": { "documents": 5, "records": 47, "validRate": 95.7 },
      "Jaén": { "documents": 3, "records": 45, "validRate": 93.3 }
    },
    "byFormat": {
      "DBF": { "files": 7, "records": 89, "validRate": 100.0 },
      "ODS": { "files": 6, "records": 72, "validRate": 93.1 },
      "ODT": { "files": 3, "records": 19, "validRate": 100.0 },
      "DOCX": { "files": 1, "records": 1, "validRate": 100.0 }
    },
    "topPatterns": [
      { "id": "DOUBLE_TILDE_DECIMAL", "uses": 67, "impact": "high" },
      { "id": "KM_DECIMAL_X", "uses": 54, "impact": "critical" },
      { "id": "SPACE_THOUSANDS", "uses": 45, "impact": "high" },
      { "id": "Y_TRUNCATED_6_ADD4", "uses": 23, "impact": "medium" },
      { "id": "Y_TRUNCATED_6_MULT10", "uses": 15, "impact": "medium" }
    ]
  }
}
